---
title: "Davis Graphs"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(fs)
library(dsbox)
library(ggridges)
library(viridis)
library(janitor)
library(scales)
library(gridExtra)
library(emojifont)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r q2-data-wrangling}
youtube <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-03-02/youtube.csv")

q2_part1_data <- filter(youtube, like_count != is.na(like_count) & dislike_count != is.na(dislike_count)) %>%
  group_by(brand) %>%
  mutate(likes_total = sum(like_count),
         dislikes_total = sum(dislike_count),
         proportion_likes_total = likes_total / (dislikes_total + likes_total),
         emoji_icon = emoji('football'),
         size_number = 1)

#q2_part1_data <- q2_part1_data %>%
 # pivot_longer(cols = bra)

#q2_part2_data <- youtube %>%
  #group_by(brand) %>%
 # mutate(proportion_likes_yearly = like_count / 
           #(like_count + dislike_count))
```

## Including Plots


```{r q1-plot1, echo=FALSE}

ggplot(q2_part1_data, aes(x = proportion_likes_total, y = brand)) + 
    geom_segment(aes(y = reorder(brand, proportion_likes_total), yend = reorder(brand, proportion_likes_total), x = 0, xend = proportion_likes_total), color = "dodgerblue1", size = 2) + 
  geom_point(color = "dodgerblue1", size = 3) + 
  theme(panel.background = element_blank(), 
        axis.ticks.y = element_blank() ) +
  coord_cartesian(xlim = c(.75, 1)) + 
  labs(title = "Proportion of likes received out of total video interactions (likes + dislikes", x = "Proportion of likes", 
       y = "Brand")
```

```{r}

q2_part1_datav2 <- filter(youtube, like_count != is.na(like_count) & dislike_count != is.na(dislike_count)) %>%
  group_by(brand) %>%
  mutate(likes_total = sum(like_count),
         dislikes_total = sum(dislike_count),
         proportion_likes_total = likes_total / (dislikes_total + likes_total),
         emoji_icon = case_when(
           brand == "Kia" ~ "ğŸš—",
           brand == "NFL" ~ "ğŸˆ",
           brand == "Pepsi" ~ "ğŸ¥¤",
           brand == "E-Trade" ~ "ğŸ“ˆ",
           brand == "Hynudai" ~ "ğŸš—",
           brand == "Toyota" ~ "ğŸš—",
           brand == "Bud Light" ~ "ğŸº",
           brand == "Budweiser" ~ "ğŸº",
           brand == "Coca-Cola" ~ "ğŸ¥¤",
           brand == "Doritos" ~ "ğŸŸ"))


ggplot(q2_part1_datav2, aes(x = proportion_likes_total, y = brand, label = emoji_icon)) + 
    geom_segment(aes(y = reorder(brand, proportion_likes_total), yend = reorder(brand, proportion_likes_total), x = 0, xend = proportion_likes_total)) + 
  geom_text(aes(label = emoji_icon))
```

