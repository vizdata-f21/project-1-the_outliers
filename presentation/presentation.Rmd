---
title: "The Battle of the Superbowl Ads"
author: "The Outliers <br> Davis Jones, Kate Straneva, Hebron Daniel, Sophie Dalldorf"
output:
  xaringan::moon_reader:
    css: xaringan-themer.css
    lib_dir: libs
    nature:
      ratio: "16:9"
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{r load-packages, include = FALSE}
library(tidyverse)
library(tidymodels)
library(palmerpenguins)
library(knitr)
library(xaringan)
library(xaringanthemer)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(fs)
library(dsbox)
library(ggridges)
library(viridis)
library(janitor)
library(scales)
library(gridExtra)
library(emojifont)
library(ggridges)
library(gganimate)
library(ggrepel)
```

```{r setup, include=FALSE}
# For better figure resolution
knitr::opts_chunk$set(
  fig.retina = 3, 
  dpi = 300, 
  fig.width = 6, 
  fig.asp = 0.618, 
  out.width = "70%"
  )
```


```{r load-data, echo = FALSE, warning = FALSE, message = FALSE}
superbowl_data <- read_csv("data/superbowldata.csv", show_col_types = FALSE)
```

```{r style-slides, echo = FALSE}
style_duo(primary_color = "#1F4257", secondary_color = "#F97B64",
          title_slide_background_image = "img/footballfield.jpg")
```


# Introduction: Superbowl Ads

.pull-left[
About This Data:

- Came from FiveThirtyEight

- 233 ads from 10 brands that aired the most spots since 2000

- Tells us information about brands, types of videos (funny, patriotic, etc.), years released, likes/dislikes, and more.
]

--

.pull-right[
Why This Dataset? 

- We all love Superbowl ads!

- We were interested to see trends over time and explore which brands were most popular!

- What makes these ads so popular?
]

```{r footballgraphic, echo = FALSE, out.width = "20%", fig.align = "bottom"}
include_graphics("img/football.png")
```
---

#Question 1: Exploring how Superbowl commerical content trends change over time...

```{r overtimegraphic, echo = FALSE, out.width = "40%", fig.align = "bottom"}
include_graphics("img/overtime.jpeg")
```

---

## Presence of Superbowl Characteristics Over Time:

```{r q1p1wrangle, echo = FALSE}
q1_p1_data <- superbowl_data %>%
  group_by(year) %>%
  summarise(funny = sum(funny),
            show_product_quickly = sum(show_product_quickly),
            patriotic = sum(patriotic),
            celebrity = sum(celebrity),
            danger= sum(danger),
            animals= sum(animals),
            use_sex = sum(use_sex)) %>%
  pivot_longer(cols = c(funny, show_product_quickly, patriotic, celebrity, danger, animals, use_sex), names_to = "type")
```


.pull-left[

```{r q1p1, out.width="100%", fig.width=4, echo = FALSE}
ggplot(q1_p1_data%>% filter(year %in% c(2000, 2005, 2010,2015, 2020)), aes(type, value, fill  = type)) +
  geom_col() + labs(title = 'Prevalence of Superbowl Ad Characteristics Over Time', x = 'Ad Type', y= " Ad Count", fill = "Ad Characteristic") + theme_minimal() + theme( axis.text.x=element_blank(), axis.title.x = element_blank(), legend.position = c(0.8, 0.2), legend.key.size = unit(.5, 'cm'),
        legend.key.height = unit(.5, 'cm'), #change legend key height
        legend.key.width = unit(.5, 'cm'), legend.background = element_rect(size = 0.5, colour = 1), axis.title.y = element_text(angle = 0, vjust = 0.5)) + scale_fill_brewer(palette = "Spectral") + facet_wrap(~year, ncol =3) + scale_y_continuous(breaks = seq(0, 12, by = 2))
```

]

.pull-right[
Analysis:

- hello
- how's it going
- who's up


]


---

## Prevalence of Ad types by Brand Type

```{r q1p2wrangle, echo = FALSE, warning = FALSE, message = FALSE}
q1_p2_data2 <- superbowl_data%>%
  mutate(brand_type = case_when(brand == "Toyota" ~ "Car", 
                               brand == "Kia" ~ "Car",
                               brand == "Hynudai" ~ "Car",
                               brand == "Bud Light" ~ "Beverage", 
                               brand == "Coca-Cola" ~ "Beverage",
                               brand == "Budweiser" ~ "Beverage", 
                               brand == "Pepsi" ~ "Beverage", 
                               brand == "Doritos" ~ "Misc.", 
                               brand == "E-Trade" ~ "Misc.", 
                               brand == "NFL" ~ "NFL", 
                               TRUE ~ "Miscellaneous"))

q1_p2_data2 <- q1_p2_data2 %>%
  group_by(brand_type) %>%
  summarise(funny = sum(funny),
            show_product_quickly = sum(show_product_quickly),
            patriotic = sum(patriotic),
            celebrity = sum(celebrity),
            danger= sum(danger),
            animals= sum(animals),
            use_sex = sum(use_sex)) %>%
  pivot_longer(cols = c(funny, show_product_quickly, patriotic, celebrity, danger, animals, use_sex), names_to = "type")

q1_p2_data2 <- q1_p2_data2 %>%
  group_by(brand_type)%>% 
  mutate(per=value/sum(value)) %>%
  mutate(labels = paste(per, "%"))
```


.pull-left[
```{r q1p2, echo = FALSE, warning = FALSE, out.width="100%", fig.width=4, message = FALSE}
ggplot(q1_p2_data2, aes(fill=type, y=per, x=brand_type)) + 
    geom_bar(position="stack", stat="identity", 
             color = "black") + coord_flip() + 
  scale_fill_brewer(palette = "Spectral") + theme_minimal()+ 
  labs(title = "Prevalence of Ad Characteristics by Brand Type", x= "Brand Type",
       y = "Percentage", fill = "Ad Features") + geom_bar(position="stack", stat="identity", color = "black") + coord_flip() + scale_fill_brewer(palette = "Spectral") + theme_minimal()+ labs(title = "Prevalence of Ad Features by Brand Category", x= "Brand Type", y = "Percentage", fill = "Ad Features")
```

]

.pull-right[
Analysis:

- hello
- how's it going
- who's up

]

---

# Question 2: Exploring the most popular Super Bowl commercial brands...

```{r examplegraphic, echo = FALSE, out.width = "80%", fig.align = "center"}
include_graphics("img/superbowladexample.jpeg")
```

---

## Proportion of likes received out of total video interactions (likes + dislikes), by brand

```{r q2p1wrangle, echo = FALSE}
q2_p1_data <- filter(superbowl_data, like_count != is.na(like_count) & dislike_count != is.na(dislike_count)) %>%
  group_by(brand) %>%
  mutate(likes_total = sum(like_count),
         dislikes_total = sum(dislike_count),
         proportion_likes_total = likes_total / (dislikes_total + likes_total))
```


.pull-left[
```{r q2p1, out.width="100%", fig.width=4, echo = FALSE}
ggplot(q2_p1_data, aes(x = proportion_likes_total, y = brand)) +
    geom_segment(aes(y = reorder(brand, proportion_likes_total), yend = reorder(brand, proportion_likes_total), x = 0, xend = proportion_likes_total), color = "dodgerblue1", size = 2) +
  geom_point(color = "dodgerblue1", size = 3) +
  coord_cartesian(xlim = c(.75, 1)) +
  labs(x = "Proportion of likes out of total interactions",
       y = "Brand") +
    theme(panel.background = element_blank(), axis.ticks.y = element_blank(),
          axis.text.y = element_text(size = 11, color = "black"),
          axis.text.x = element_text(size = 11, color = "black"),
          axis.title.x = element_text(size = 12),
          axis.title.y = element_text(size = 12))
```

]

.pull-right[
Analysis:

- Kia, the NFL, Pepsi, and E-Trade
SuperBowl commercials all received a high proportion of likes
- Budweiser, Coca-Cola, and Doritos received
the lowest proportion of likes
- Similarities in popularity by similar types of brands (Toyota and Hyundai; Bud Light and Budweiser)
- What does this tell us going forward?

]

---

## Average Total Comments vs. Average Total Views by brand

```{r q2p2wrangle, echo = FALSE}
q2_p2_data <- filter(superbowl_data, comment_count != is.na(comment_count) &
                         view_count != is.na(view_count)) %>%
  group_by(brand) %>%
  summarise(avg_total_comments = mean(comment_count),
         avg_total_views = mean(view_count))
```

.pull-left[
```{r q2p2, out.width="100%", fig.width=5, echo = FALSE}
ggplot(q2_p2_data, aes(x = avg_total_views, y = avg_total_comments)) +
         geom_point(aes(color = brand), show.legend = FALSE) +
  geom_text_repel(aes(label = brand)) +
  scale_y_log10() +
  scale_x_log10(labels = unit_format(unit = "M", scale = 1e-6)) +
  labs(x = "Average Total Views", y = "Average Total Comments",
       caption = "Axes on log10 scale, labels are raw units")
```
]

.pull-right[
Analysis:

- Not what we expected based on first graph...
- Kia (top-rated brand in the first
visualization) had the lowest average view and comment values
- Does the audienceâ€™s reactions to a commercial have much of a relationship
to the number of views and comments it receives? Probably not...
- Interesting finding: all the car companies were in the lower left portion: why?

]


---

# Questions?

```{r questiongraphic, echo = FALSE, out.width = "80%", fig.align = "center"}
include_graphics("img/questions.jpeg")
```
