---
title: Superbowl Ads 
author: The Outliers
output: github_document
---

```{r load-packages, echo = FALSE}
library(tidyverse)
library(fs)
library(dsbox)
library(ggridges)
library(viridis)
library(janitor)
library(scales)
library(gridExtra)
library(emojifont)
```

```{r load-data, echo = FALSE}
superbowl_data <- read_csv("data/superbowldata.csv", show_col_types = FALSE)
```

## Introduction

[add in Hebron's work]

## Exploring how Super Bowl commercial content trends change over time 

### Introduction

[add in Hebron's work]

### Approach

[(1-2 paragraphs)
Describe what types of plots you are going to make to address your question.
For each plot, provide a clear explanation as to why this plot (e.g. boxplot, barplot, histogram, etc.) is best for providing the information you are asking about. 
The two plots should be of different types, and at least one of the two plots needs to use either color mapping or facets.]

### Analysis

#### Wrangling data

```{r q1_p1_wrangling}

q1_p1_data <- superbowl_data %>%
  group_by(year) %>%
  summarise(funny_count = sum(funny),
            show_product_quickly_count = sum(show_product_quickly),
            patriotic_count = sum(patriotic),
            celebrity_count = sum(celebrity),
            danger_count = sum(danger),
            animals_count = sum(animals),
            use_sex_count = sum(use_sex)) %>%
  pivot_longer(cols = c(funny_count, show_product_quickly_count, patriotic_count, celebrity_count, danger_count, animals_count, use_sex_count), names_to = "type")

```

#### Visualization one 

```{r q1_p1_graph}
ggplot(data = q1_p1_data, aes(x = year, y = value, color = type)) +
  geom_line() +
  labs(title = "Prevelance of Different Types of Ads Over Time", x = "Year", y = "Count")
```

#### Visualization two 


```{r q1_p2_wrangling}

q1_p2_data <- superbowl_data %>%
  filter(show_product_quickly  == TRUE, 
         danger == TRUE, 
         celebrity == TRUE)

```


```{r q1_p2_graph}

ggplot(data = q1_p2_data, aes(x = like_count, y = view_count, color = brand)) +
  geom_point() + 
  labs(title = "Proportion of Likes/Dislikes Over time for ads containing danger,
       celebrities, and shows_product_quickly", x = "Like_Count", y = "View_Count") + theme_minimal()

```

[(2-3 code blocks, 2 figures, text/code comments as needed)
In this section, provide the code that generates your plots. Use scale functions to provide nice axis labels and guides.
You are welcome to use theme functions to customize the appearance of your plot, but you are not required to do so.
All plots must be made with ggplot2. Do not use base R or lattice plotting functions.]

### Discussion

[(1-3 paragraphs)
In the Discussion section, interpret the results of your analysis. Identify any trends revealed (or not revealed) by the plots.
Speculate about why the data looks the way it does.]

## Exploring the most popular Super Bowl commercial brands

### Introduction

[Hebron's work here]

### Approach

[(1-2 paragraphs)
Describe what types of plots you are going to make to address your question.
For each plot, provide a clear explanation as to why this plot (e.g. boxplot, barplot, histogram, etc.) is best for providing the information you are asking about. 
The two plots should be of different types, and at least one of the two plots needs to use either color mapping or facets.]

### Analysis

```{r q2_p1_wrangling}

q2_p1_data <- filter(superbowl_data, like_count != is.na(like_count) & dislike_count != is.na(dislike_count)) %>%
  group_by(brand) %>%
  mutate(likes_total = sum(like_count),
         dislikes_total = sum(dislike_count),
         proportion_likes_total = likes_total / (dislikes_total + likes_total))

```

```{r q2_p1_graph, echo=FALSE}

ggplot(q2_p1_data, aes(x = proportion_likes_total, y = brand)) + 
    geom_segment(aes(y = reorder(brand, proportion_likes_total), yend = reorder(brand, proportion_likes_total), x = 0, xend = proportion_likes_total), color = "dodgerblue1", size = 2) + 
  geom_point(color = "dodgerblue1", size = 3) + 
  coord_cartesian(xlim = c(.75, 1)) + 
  labs(title = "Proportion of likes received out of total video interactions (likes + dislikes)", x = "Proportion of likes out of total interactions", 
       y = "Brand") + 
    theme(panel.background = element_blank(), axis.ticks.y = element_blank(),
          axis.text.y = element_text(size = 11, color = "black"), 
          axis.text.x = element_text(size = 11, color = "black"),
          axis.title.x = element_text(size = 12),
          axis.title.y = element_text(size = 12))
```

```{r Q2_p2_wrangling}

q2_p2_data <- superbowl_data %>%
  filter(brand == c("Kia", "NFL", "Pepsi", "E-Trade"))%>%
  group_by(year, brand) %>%
  mutate(proportion_likes_yearly = like_count / (like_count + dislike_count))

```

```{r q2_p2_graph}

ggplot(data = q2_p2_data, aes(x = year, y = proportion_likes_yearly, color = brand)) +
  geom_point() + 
  labs(title = "Proportion of Likes/Dislikes over time for the top 3 Brands", x = "Year", y = "Count") + theme_minimal()

```

[(2-3 code blocks, 2 figures, text/code comments as needed)
In this section, provide the code that generates your plots. Use scale functions to provide nice axis labels and guides.
You are welcome to use theme functions to customize the appearance of your plot, but you are not required to do so.
All plots must be made with ggplot2. Do not use base R or lattice plotting functions.]

### Discussion

(1-3 paragraphs)
In the Discussion section, interpret the results of your analysis. Identify any trends revealed (or not revealed) by the plots.
Speculate about why the data looks the way it does.

## Presentation

Our presentation can be found [here](presentation/presentation.html).

## Data 

Include a citation for your data here. 
See http://libraryguides.vu.edu.au/c.php?g=386501&p=4347840 for guidance on proper citation for datasets. 
If you got your data off the web, make sure to note the retrieval date.

## References

List any references here. You should, at a minimum, list your data source.
